<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Cyber Security Awareness Training — Action Required</title>
  <meta name="description" content="Controlled security awareness exercise."/>
  
  <!-- Load Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  
  <!-- Load Google Font 'Inter' -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

  <!-- Green lock icon for the browser tab -->
  <link rel="icon" href='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="%2322c55e"><path d="M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zM9 6c0-1.66 1.34-3 3-3s3 1.34 3 3v2H9V6zm9 14H6V10h12v10zm-6-3c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2z"/></svg>'>
  
  <style>
    /* Use Inter as the default font */
    body {
      font-family: 'Inter', system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
    }
  </style>
</head>
<body class="bg-gray-100 flex items-center justify-center min-h-screen p-4">

  <main class="bg-white rounded-lg shadow-xl p-8 max-w-4xl w-full" role="main" aria-labelledby="title">
    
    <div class="flex items-center mb-6">
      <!-- Modern Shield Icon -->
      <div class="bg-blue-100 text-blue-600 rounded-full p-3 mr-4">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-8 h-8">
          <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75L11.25 15 15 9.75m-3-7.036A11.959 11.959 0 013.598 6 11.99 11.99 0 003 9.749c0 5.592 3.824 10.29 9 11.623 5.176-1.333 9-6.03 9-11.623 0-1.314-.213-2.622-.602-3.852A11.959 11.959 0 0115 2.714v.001M9 12.75L11.25 15 15 9.75M3 9.749c0 5.592 3.824 10.29 9 11.623 5.176-1.333 9-6.03 9-11.623V9.749M3 9.749h18" />
        </svg>
      </div>
      <div>
        <h1 id="title" class="text-2xl font-bold text-gray-900">Security Awareness Exercise — Action Required</h1>
        <p class="text-gray-600 text-lg">This is a controlled exercise from <strong>CyberSecurity LLC</strong>.</p>
      </div>
    </div>
    
    <p class="text-gray-700 mb-6">We detected a click on a simulated awareness link associated with your account. If you clicked the link, we recorded that action for training purposes. This helps us measure awareness and provide targeted training. Please complete the short enrollment below to strengthen your organization’s security posture.</p>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-6" role="region" aria-label="Enrollment area">
      
      <!-- Key Takeaways Panel -->
      <div class="bg-gray-50 rounded-lg p-6 border border-gray-200" id="infoPanel" aria-live="polite">
        <h2 class="text-xl font-semibold text-gray-900 mb-4">Key Takeaways</h2>
        
        <!-- Re-formatted h2 tags as a proper list -->
        <ul class="space-y-3 text-gray-700">
          <li class="flex items-start">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5 text-red-500 mr-3 mt-1 flex-shrink-0">
              <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z" />
            </svg>
            <span><strong>Do not click unknown links</strong> or open suspicious attachments.</span>
          </li>
          <li class="flex items-start">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5 text-yellow-500 mr-3 mt-1 flex-shrink-0">
              <path stroke-linecap="round" stroke-linejoin="round" d="M9.879 7.519c1.171-1.025 3.071-1.025 4.242 0 1.172 1.025 1.172 2.687 0 3.712-.203.179-.43.326-.668.445l.743 1.486c.08.17.04.38-.097.5-1.13-1.049-2.298-2.12-3.468-3.21-1.171-1.09-1.859-2.58-1.859-4.15 0-2.254 1.836-4.09 4.09-4.09 1.127 0 2.166.46 2.907 1.205" />
            </svg>
            <span><strong>Question emails that create a sense of urgency.</strong> This is a common tactic.</span>
          </li>
          <li class="flex items-start">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5 text-green-500 mr-3 mt-1 flex-shrink-0">
              <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75L11.25 15 15 9.75m-3-7.036A11.959 11.959 0 013.598 6 11.99 11.99 0 003 9.749c0 5.592 3.824 10.29 9 11.623 5.176-1.333 9-6.03 9-11.623 0-1.314-.213-2.622-.602-3.852A11.959 11.959 0 0115 2.714v.001" />
            </svg>
            <span><strong>Trust but verify.</strong> If an email seems unusual, verify it through another channel.</span>
          </li>
          <li class="flex items-start">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5 text-blue-500 mr-3 mt-1 flex-shrink-0">
              <path stroke-linecap="round" stroke-linejoin="round" d="M9 17.25v1.007a3 3 0 01-.375 1.519l-7.12 1.154a3 3 0 01-3.675-3.109l.633-1.266a3 3 0 013.11-1.897l2.12.042a3 3 0 013.09 2.753zM9 17.25V9.75M9 9.75c0-1.036.84-1.875 1.875-1.875h.375c1.036 0 1.875.84 1.875 1.875v7.5c0 1.035-.84 1.875-1.875 1.875h-.375C9.84 19.125 9 18.285 9 17.25z" />
            </svg>
            <span><strong>Report Phishing Emails Immediately.</strong> Be Cyber Strong and help protect others.</span>
          </li>
        </ul>
      </div>

      <!-- Action Panel -->
      <div class="bg-blue-50 rounded-lg p-6 border border-blue-200 flex flex-col justify-between">
        <div>
          <h2 class="text-xl font-semibold text-gray-900 mb-2">Next Step: Enroll</h2>
          <p class="text-gray-700 mb-4">Please enroll in the brief, mandatory training module to complete this exercise. Your participation is crucial to our collective security.</p>
        </div>
        
        <div>
          <button class="w-full bg-blue-600 text-white font-bold py-3 px-5 rounded-lg hover:bg-blue-700 transition-colors duration-200" id="enrollBtn">
            Enroll in Training Now
          </button>
          
          <footer class="text-sm text-gray-600 mt-4 text-center">
            Questions? Contact 
            <a href="mailto:c3c1w1e7t5y2y0n0@cybersecurity-llc.slack.com" class="font-medium text-blue-600 hover:underline">training@cybersecurity-llc.io</a>
          </footer>
        </div>
      </div>

    </div>
  </main>

  <script>
    /**
     * Configuration - replace TRACKING_URL and LMS_ENROLL_URL appropriately.
     * - TRACKING_URL: your server endpoint that will accept token (GET/POST) and log IP/UA/timestamp
     * - This page expects a query param "t" (token) e.g. ?t=UUID-OR-HMAC
     */
    const TRACKING_URL = 'https://cybersecurity-llc.github.io/track'; // <-- REPLACE with your tracking endpoint
    const LMS_ENROLL_URL = 'https://info.knowbe4.com/cybersecurity-awareness-month-ps'; // optional: LMS enrollment link or API proxy
    const RETENTION_DAYS = 180;

    // Utility to read query params (token)
    function getQueryParam(name) {
      const urlParams = new URLSearchParams(window.location.search);
      return urlParams.get(name);
    }

    const token = getQueryParam('t') || null;

    // Send tracking data (best-effort). Use fetch (POST) and an image-beacon fallback for non-JS/blocked fetch.
    (function sendTracking() {
      if (!token) {
        console.warn('No token present in URL (param "t"). Tracking will proceed anonymously.');
      }

      const payload = {
        token: token,
        path: window.location.pathname + window.location.search,
        referrer: document.referrer || null,
        page: window.location.href,
        // do NOT include any credentials or PII here
      };

      // Primary: POST via fetch
      try {
        fetch(TRACKING_URL, {
          method: 'POST',
          headers: {'Content-Type': 'application/json'},
          body: JSON.stringify(payload),
          keepalive: true // helps send data even when navigating away
        }).then(resp => {
          if (!resp.ok) console.warn('Tracking POST failed', resp.status);
        }).catch(err => console.warn('Tracking POST error', err));
      } catch (e) {
        console.warn('Fetch tracking not available', e);
      }

      // Fallback beacon: 1x1 image GET (the server will receive an image request and can log IP/UA)
      const img = new Image(1,1);
      img.src = TRACKING_URL + '?t=' + encodeURIComponent(token || '') + '&_=' + Date.now();
      img.alt = '';
      img.style.display = 'none';
      document.body.appendChild(img);
    })();

    // Button handler - call your LMS enrollment path (either direct link or backend API)
    document.getElementById('enrollBtn').addEventListener('click', async () => {
      // If you have a backend that assigns training via LMS API, call it here.
      try {
        const res = await fetch(TRACKING_URL + '/enroll', {
          method: 'POST',
          headers: {'Content-Type':'application/json'},
          body: JSON.stringify({ token })
        });
        
        // --- Visually update the button on success ---
        const enrollBtn = document.getElementById('enrollBtn');
        enrollBtn.textContent = 'Enrolling...';
        enrollBtn.disabled = true;
        enrollBtn.classList.add('opacity-75', 'cursor-not-allowed');
        // ---

        if (res.ok) {
          // Update UI to show success
          enrollBtn.textContent = 'Enrollment Successful!';
          enrollBtn.classList.remove('bg-blue-600', 'hover:bg-blue-700');
          enrollBtn.classList.add('bg-green-600');
          
          // Optionally redirect after a short delay
          // setTimeout(() => {
          //   window.location.href = LMS_ENROLL_URL; // Or a success page
          // }, 2000);

        } else {
          // fallback: redirect to LMS enroll page with token as query param
          window.location.href = LMS_ENROLL_URL + (LMS_ENROLL_URL.includes('?') ? '&' : '?') + 't=' + encodeURIComponent(token || '');
        }
      } catch (err) {
        // fallback redirect
        window.location.href = LMS_ENROLL_URL + (LMS_ENROLL_URL.includes('?') ? '&' : '?') + 't=' + encodeURIComponent(token || '');
      }
    });

    // NOTE: The 'alreadyBtn' was not in your original HTML, so I have removed the listener for it.
    // If you add that button back, you can uncomment this:
    /*
    document.getElementById('alreadyBtn').addEventListener('click', async () => {
      try {
        await fetch(TRACKING_URL + '/already', {
          method: 'POST', headers: {'Content-Type':'application/json'}, body: JSON.stringify({ token })
        });
        // Update UI to show success
      } catch (e) {
        // Handle error
      }
    });
    */
  </script>
</body>
</html>
