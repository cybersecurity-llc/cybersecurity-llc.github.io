<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Security Awareness Training — Action Required</title>
  <meta name="description" content="Controlled security awareness exercise."/>
  
  <!-- Added green lock icon for the browser tab -->
  <link rel="icon" href='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="%2322c55e"><path d="M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zM9 6c0-1.66 1.34-3 3-3s3 1.34 3 3v2H9V6zm9 14H6V10h12v10zm-6-3c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2z"/></svg>'>
  
  <style>
    :root{--bg:#0f1724;--card:#0b1220;--accent:#06b6d4;--muted:#94a3b8}
    html,body{height:100%}
    body{font-family:Inter,system-ui,Segoe UI,Roboto,"Helvetica Neue",Arial,sans-serif;margin:0;background:linear-gradient(180deg,#071022 0%,#05101a 100%);color:#e6eef6;display:flex;align-items:center;justify-content:center;padding:24px}
    .card{max-width:820px;width:100%;background:linear-gradient(180deg,rgba(255,255,255,0.02),rgba(255,255,255,0.01));border-radius:12px;padding:28px;box-shadow:0 10px 30px rgba(2,6,23,0.6)}
    h1{margin:0 0 6px;font-size:1.6rem}
    p.lead{margin:0 0 18px;color:var(--muted)}
    .grid{display:grid;grid-template-columns:1fr 300px;gap:20px}
    .panel{background:rgba(0,0,0,0.12);padding:18px;border-radius:8px}
    .cta{display:flex;gap:10px;margin-top:16px}
    .btn{background:var(--accent);color:#052025;border:none;padding:10px 14px;border-radius:8px;font-weight:600;cursor:pointer}
    .btn.secondary{background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--muted)}
    footer{font-size:0.85rem;color:var(--muted);margin-top:14px}
    @media(max-width:900px){.grid{grid-template-columns:1fr}}
  </style>
</head>
<body>
  <main class="card" role="main" aria-labelledby="title">
    <h1 id="title">Security Awareness Exercise — Action Required</h1>
    <p class="lead">This is a controlled security awareness exercise run by <strong>CyberSecurity LLC</strong>. We detected a click on a simulated awareness link associated with your account. Please complete the short enrollment below to strengthen your organization’s security posture.</p>

    <div class="grid" role="region" aria-label="Enrollment area">
      <div class="panel" id="infoPanel" aria-live="polite">
        <h2 style="margin-top:0">What happened</h2>
        <p>If you clicked the link in the email, we recorded that action for training purposes. This helps us measure awareness and provide targeted training.</p>

        <h3 style="margin-bottom:6px">Do not open suspicious attachments or click unknown links, be cautious of emails with a sense of urgency!</h3>
        <ul style="margin:0 0 12px 18px;color:var(--muted)">
          <li>Report Phishing Emails Immediately</li>
          <li>If suspicious, delicious or malicious report it!</li>
          <li>Don't get Hacked!</li>
          <li>Be Cyber Strong</li>
        </ul>

        <div class="cta">
          <button class="btn" id="enrollBtn">Enroll in training</button>
          <button class="btn secondary" id="alreadyBtn">I already completed training</button>
        </div>

        <footer>
          Questions? Contact Cybersecurity<a href="mailto:security@cybersecurity-llc.com" style="color:var(--accent);text-decoration:none">aryancyber@bugcrowdninja.com</a>.
          <div style="margin-top:6px;color:var(--muted);font-size:0.85rem">
            Data retention: click logs are retained for 180 days by policy. See privacy policy for details.
          </div>
        </footer>
      </div>

      <div class="panel" id="statusPanel" style="display:flex;flex-direction:column;align-items:center;justify-content:center">
        <div style="text-align:center">
          <svg width="76" height="76" viewBox="0 0 24 24" fill="none" aria-hidden="true" style="margin-bottom:8px">
            <path d="M12 2L2 7v7c0 5 3.8 9.4 10 11 6.2-1.6 10-6 10-11V7l-10-5z" stroke="currentColor" stroke-width="0.6" opacity="0.8"/>
          </svg>
          <div id="statusText" style="font-weight:600;margin-bottom:6px">Security Awareness Training Needed</div>
          <div style="color:var(--muted);font-size:0.95rem" id="subText"></div>
        </div>
      </div>
    </div>
  </main>

  <script>
    /**
     * Configuration - replace TRACKING_URL and LMS_ENROLL_URL appropriately.
     * - TRACKING_URL: your server endpoint that will accept token (GET/POST) and log IP/UA/timestamp
     * - This page expects a query param "t" (token) e.g. ?t=UUID-OR-HMAC
     */
    const TRACKING_URL = 'https://cybersecurity-llc.github.io/track'; // <-- REPLACE with your tracking endpoint
    const LMS_ENROLL_URL = 'https://lms.cybersecurity-llc.github.io/enroll'; // optional: LMS enrollment link or API proxy
    const RETENTION_DAYS = 180;

    // Utility to read query params (token)
    function getQueryParam(name) {
      const urlParams = new URLSearchParams(window.location.search);
      return urlParams.get(name);
    }

    const token = getQueryParam('t') || null;

    // Send tracking data (best-effort). Use fetch (POST) and an image-beacon fallback for non-JS/blocked fetch.
    (function sendTracking() {
      if (!token) {
        console.warn('No token present in URL (param "t"). Tracking will proceed anonymously.');
      }

      const payload = {
        token: token,
        path: window.location.pathname + window.location.search,
        referrer: document.referrer || null,
        page: window.location.href,
        // do NOT include any credentials or PII here
      };

      // Primary: POST via fetch
      try {
        fetch(TRACKING_URL, {
          method: 'POST',
          headers: {'Content-Type': 'application/json'},
          body: JSON.stringify(payload),
          keepalive: true // helps send data even when navigating away
        }).then(resp => {
          if (!resp.ok) console.warn('Tracking POST failed', resp.status);
        }).catch(err => console.warn('Tracking POST error', err));
      } catch (e) {
        console.warn('Fetch tracking not available', e);
      }

      // Fallback beacon: 1x1 image GET (the server will receive an image request and can log IP/UA)
      const img = new Image(1,1);
      img.src = TRACKING_URL + '?t=' + encodeURIComponent(token || '') + '&_=' + Date.now();
      img.alt = '';
      img.style.display = 'none';
      document.body.appendChild(img);
    })();

    // Button handlers - call your LMS enrollment path (either direct link or backend API)
    document.getElementById('enrollBtn').addEventListener('click', async () => {
      // If you have a backend that assigns training via LMS API, call it here.
      try {
        const res = await fetch(TRACKING_URL + '/enroll', {
          method: 'POST',
          headers: {'Content-Type':'application/json'},
          body: JSON.stringify({ token })
        });
        if (res.ok) {
          document.getElementById('statusText').textContent = 'Enrollment assigned';
          document.getElementById('subText').textContent = 'Training was successfully assigned. Check your email for details.';
        } else {
          // fallback: redirect to LMS enroll page with token as query param
          window.location.href = LMS_ENROLL_URL + (LMS_ENROLL_URL.includes('?') ? '&' : '?') + 't=' + encodeURIComponent(token || '');
        }
      } catch (err) {
        // fallback redirect
        window.location.href = LMS_ENROLL_URL + (LMS_ENROLL_URL.includes('?') ? '&' : '?') + 't=' + encodeURIComponent(token || '');
      }
    });

    document.getElementById('alreadyBtn').addEventListener('click', async () => {
      try {
        await fetch(TRACKING_URL + '/already', {
          method: 'POST', headers: {'Content-Type':'application/json'}, body: JSON.stringify({ token })
        });
        document.getElementById('statusText').textContent = 'Marked complete';
        document.getElementById('subText').textContent = 'Thank you — your completion has been recorded.';
      } catch (e) {
        document.getElementById('statusText').textContent = 'Action recorded';
      }
    });
  </script>
</body>
</html>
